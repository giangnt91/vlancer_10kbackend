<!-- BEGIN BASE-->
<div id="base">
    <!-- BEGIN CONTENT-->
    <div id="content">
        <section>
            <div class="section-body">
                <div class="row">
                    <!-- BEGIN ALERT - REVENUE -->
                    <div class="col-md-3 col-sm-6">
                        <div class="card">
                            <div class="card-body no-padding">
                                <div class="alert alert-callout alert-info no-margin ink-reaction">
                                    <strong class="text-info text-xl">
                                        <i class="md md-dashboard"></i>
                                        <span>{{basic.length}}</span>
                                    </strong>
                                    <br />
                                    <span class="opacity-50">Tổng Số Mã Giảm Giá</span>
                                    <div class="stick-bottom-left-right">
                                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                                    </div>
                                </div>
                            </div>
                            <!--end .card-body -->
                        </div>
                        <!--end .card -->
                    </div>
                    <!--end .col -->
                    <!-- END ALERT - REVENUE -->

                    <!-- BEGIN ALERT - REVENUE -->
                    <div class="col-md-3 col-sm-6">
                        <div class="card">
                            <div class="card-body no-padding">
                                <div class="alert alert-callout alert-danger no-margin ink-reaction" data-toggle="modal"
                                    data-target="#create">
                                    <strong class="text-danger text-xl">
                                        <i class="md md-border-color"></i>
                                        <span>Tạo Mã</span>
                                    </strong>
                                    <br />
                                    <span class="opacity-50">Tạo Mã Giảm Giá</span>
                                    <div class="stick-bottom-left-right">
                                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                                    </div>
                                </div>
                            </div>
                            <!--end .card-body -->
                        </div>
                        <!--end .card -->
                    </div>
                    <!--end .col -->
                    <!-- END ALERT - REVENUE -->

                    <!-- BEGIN ALERT - REVENUE -->
                    <div class="col-md-3 col-sm-6">
                        <div class="card">
                            <div class="card-body no-padding">
                                <div class="alert alert-callout alert-success no-margin ink-reaction"
                                    data-toggle="modal" data-target="#emarket">
                                    <strong class="text-success text-xl">
                                        <i class="md md-border-color"></i>
                                        <span>Tạo Web</span>
                                    </strong>
                                    <br />
                                    <span class="opacity-50">Tạo Trang Thương Mại Điện Tử</span>
                                    <div class="stick-bottom-left-right">
                                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                                    </div>
                                </div>
                            </div>
                            <!--end .card-body -->
                        </div>
                        <!--end .card -->
                    </div>
                    <!--end .col -->
                    <!-- END ALERT - REVENUE -->

                    <!-- BEGIN ALERT - REVENUE -->
                    <div class="col-md-3 col-sm-6">
                        <div class="card">
                            <div class="card-body no-padding">
                                <div class="alert alert-callout alert-warning no-margin ink-reaction"
                                    data-toggle="modal" data-target="#upemarket">
                                    <strong class="text-warning text-xl">
                                        <i class="md md-save"></i>
                                        <span>Cập Nhật</span>
                                    </strong>
                                    <br />
                                    <span class="opacity-50">Cập Nhật Trang Thương Mại Điện Tử</span>
                                    <div class="stick-bottom-left-right">
                                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                                    </div>
                                </div>
                            </div>
                            <!--end .card-body -->
                        </div>
                        <!--end .card -->
                    </div>
                    <!--end .col -->
                    <!-- END ALERT - REVENUE -->


                </div>

                <div class="row">
                    <!--end .col -->
                    <button class="btn btn-link" ng-click="exportToExcel('#shops')">
                        <span class="glyphicon glyphicon-share"></span>
                        Export to Excel
                    </button>
                    <div class="col-lg-12">
                        <div class="table-responsive alert alert-callout no-margin tbaction" style="overflow-x:unset;">
                            <h2 ng-if="basic.length === 0" class="text-center">Không có dữ liệu</h2>
                            <table ng-if="basic.length > 0" datatable="" dt-options="dtOptions" dt-columns=""
                                class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th width="50px">STT</th>
                                        <th>Web Thương Mại ĐT</th>
                                        <th>Mã Giảm Giá</th>
                                        <th>Nghành Hàng</th>
                                        <th hidden>Url</th>
                                        <th>Giá Trị</th>
                                        <th>Thông Tin</th>
                                        <th>Ngày Đăng</th>
                                        <th>Thời Hạn Sử Dụng</th>
                                        <th>Trạng Thái</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="content in basic">
                                        <td>{{$index + 1}}</td>
                                        <td>
                                            {{content.Ename}}
                                        </td>
                                        <td>
                                            {{content.Code}}
                                        </td>
                                        <td>
                                            {{content.Industry}}
                                        </td>
                                        <td hidden>
                                            {{content.Url}}
                                        </td>
                                        <td>
                                            {{content.ValueC[0].value}} {{content.ValueC[0].name}}
                                        </td>
                                        <td>
                                            {{content.Info}}
                                        </td>
                                        <td>
                                            {{content.Releaseday}}
                                        </td>
                                        <td>
                                            {{content.Expireday}}
                                        </td>
                                        <td>{{content._Status[0].name}}</td>
                                        <td class="text-center">
                                            <button type="button" class="btn btn-success ink-reaction"
                                                data-toggle="modal" data-target="#update"
                                                ng-click="get_id_action(content._id)">
                                                <i class="md md-mode-edit"></i>
                                            </button>
                                            &nbsp;
                                            <button type="button" class="btn btn-danger ink-reaction"
                                                data-toggle="modal" data-target="#delete"
                                                ng-click="get_id_action(content._id)">
                                                <i class="md md-delete"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!--end .table-responsive -->
                        <!-- END DATATABLE 1 -->
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- Update -->
<div id="update" class="modal fade" data-backdrop="static" data-keyboard="false" role="dialog">
    <div class="modal-dialog">

        <!-- update action -->
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
                <h4 class="modal-title">Cập Nhật Mã Giảm Giá</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <form class="form">
                        <div class="alert alert-info" ng-show="waiting">
                            <strong>Waiting!</strong> Đang xử lý dữ liệu vui lòng đợi ...
                        </div>
                        <div class="alert alert-warning" ng-show="error">
                            <strong>Cảnh Báo!</strong> Phải nhập đầy đủ thông tin để cập nhật mã giảm giá.
                        </div>
                        <div class="alert alert-success" ng-show="success">
                            <strong>Thành Công!</strong> Mã giảm giá đã được cập nhật.
                        </div>
                        <div class="alert alert-danger" ng-show="server_error">
                            <strong>Không Thành Công!</strong> Có lỗi trong quá trình xử lý.
                        </div>
                        <div class="form-group">
                            <label for="mstatus">Trang Thương Mại Điện Tử</label>
                            <select class="form-control" ng-model="chooseEmarket2"
                                ng-options="option.Ename for option in list_Emarket">
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="uCode" ng-model="detail.Code">
                            <label for="Code">Mã Giảm Giá</label>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="uUrl" ng-model="detail.Url">
                            <label for="Url">Url Website</label>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="uactionUrl" ng-model="detail.Industry">
                            <label for="actionUrl">Ngành Hàng</label>
                        </div>

                        <div class="form-group">
                            <label for="info">Thông Tin</label>
                            <textarea name="info" id="info" class="form-control" rows="2" placeholder=""
                                ng-model="detail.Info"></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-success">
                                    <input type="radio" name="price" value="1" ng-model="uloai"
                                        ng-checked="detail.ValueC[0].id === 1">
                                    <span>VNĐ</span>
                                </label>

                            </div>
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-warning">
                                    <input type="radio" name="price" value="2" ng-model="uloai"
                                        ng-checked="detail.ValueC[0].id === 2">
                                    <span>%</span>
                                </label>
                            </div>
                            <div class="col-md-8 col-sm-6">
                                <div class="form-group">
                                    <input type="text" class="form-control" id="cval" ng-model="detail.ValueC[0].value">
                                    <label for="cval">Giá Trị</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <input id="enday2" type="text" class="form-control ran">
                            <label>Ngày Hết Hạn</label>
                        </div>
                    </form>
                </div>
                <!--end .card-body -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" ng-click="update(detail)">
                    Cập Nhật
                </button>
            </div>
        </div>

    </div>
</div>
<!-- update -->

<div id="create" class="modal fade" data-backdrop="static" data-keyboard="false" role="dialog">
    <div class="modal-dialog">
        <!-- create action-->
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
                <h4 class="modal-title">Tạo Mã Giảm Giá</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <form class="form">
                        <div class="alert alert-info" ng-show="waiting">
                            <strong>Waiting!</strong> Đang xử lý dữ liệu vui lòng đợi ...
                        </div>
                        <div class="alert alert-warning" ng-show="error">
                            <strong>Cảnh Báo!</strong> Phải nhập đầy đủ thông tin để tạo mã giảm giá mới.
                        </div>
                        <div class="alert alert-success" ng-show="success">
                            <strong>Thành Công!</strong> Mã giảm giá mới đã được tạo.
                        </div>
                        <div class="alert alert-danger" ng-show="server_error">
                            <strong>Không Thành Công!</strong> Có lỗi trong quá trình xử lý.
                        </div>
                        <div class="form-group">
                            <label for="mstatus">Trang Thương Mại Điện Tử</label>
                            <select class="form-control" ng-model="chooseEmarket"
                                ng-options="option.Ename for option in list_Emarket">
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="basiccode" ng-model="data.basiccode">
                            <label for="basiccode">Mã Giảm Giá</label>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="actionUrl" ng-model="data.url">
                            <label for="actionUrl">Url Website</label>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="actionUrl" ng-model="data.nganhhang">
                            <label for="actionUrl">Ngành Hàng</label>
                        </div>

                        <div class="form-group">
                            <label for="info">Thông Tin</label>
                            <textarea name="info" id="info" class="form-control" rows="2" placeholder=""
                                ng-model="data.info"></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-success">
                                    <input type="radio" name="price" value="1" ng-model="loai">
                                    <span>VNĐ</span>
                                </label>

                            </div>
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-warning">
                                    <input type="radio" name="price" value="2" ng-model="loai">
                                    <span>%</span>
                                </label>
                            </div>
                            <div class="col-md-8 col-sm-6">
                                <div class="form-group">
                                    <input type="text" class="form-control" id="ucval" ng-model="data.value">
                                    <label for="ucval">Giá Trị</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <input id="enday" type="text" class="form-control ran">
                            <label>Ngày Hết Hạn</label>
                        </div>
                    </form>
                </div>
                <!--end .card-body -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" ng-click="create(data)">
                    Tạo
                </button>
            </div>
        </div>
    </div>
</div>

<!-- tạo trang thương mại điện tử -->
<div id="emarket" class="modal fade" data-backdrop="static" data-keyboard="false" role="dialog">
    <div class="modal-dialog">
        <!-- create action-->
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
                <h4 class="modal-title">Tạo Trang Thương Mại Điện Tử</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <form class="form">
                        <div class="alert alert-info" ng-show="waiting">
                            <strong>Waiting!</strong> Đang xử lý dữ liệu vui lòng đợi ...
                        </div>
                        <div class="alert alert-warning" ng-show="error">
                            <strong>Cảnh Báo!</strong> Phải nhập đầy đủ thông tin để tạo mã giảm giá mới.
                        </div>
                        <div class="alert alert-success" ng-show="success">
                            <strong>Thành Công!</strong> Mã giảm giá mới đã được tạo.
                        </div>
                        <div class="alert alert-danger" ng-show="server_error">
                            <strong>Không Thành Công!</strong> Có lỗi trong quá trình xử lý.
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="ename" ng-model="data.ename">
                            <label for="ename">Tên Trang</label>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="eimg" ng-model="data.eimg">
                            <label for="eimg">Url Hình Đại Diện</label>
                        </div>
                    </form>
                </div>
                <!--end .card-body -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" ng-click="createEmarket(data)">
                    Tạo
                </button>
            </div>
        </div>
    </div>
</div>

<!-- cập nhật trang thương mại điện tử -->
<div id="upemarket" class="modal fade" data-backdrop="static" data-keyboard="false" role="dialog">
    <div class="modal-dialog">
        <!-- create action-->
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
                <h4 class="modal-title">Cập Nhật Trang Thương Mại Điện Tử</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <form class="form">
                        <div class="form-group">
                            <select class="form-control" ng-model="chooseEmarket"
                                ng-options="option.Ename for option in list_Emarket">
                            </select>
                            <label for="ename">Chọn Trang TMĐT</label>
                        </div>

                        <div ng-show="chooseEmarket._id !== null">
                            <div class="form-group">
                                <input type="text" class="form-control" id="ename" ng-model="chooseEmarket.Ename">
                                <label for="ename">Tên Trang</label>
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control" id="eimg" ng-model="chooseEmarket.Eimg">
                                <label for="eimg">Url Hình Đại Diện</label>
                            </div>
                        </div>
                    </form>
                </div>
                <!--end .card-body -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" ng-click="updateEmarket(chooseEmarket)">
                    Cập Nhật
                </button>
            </div>
        </div>
    </div>
</div>



<!-- Modal delete -->
<div class="modal fade" id="delete" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Confirm Delete</h4>
            </div>

            <div class="modal-body">
                <h4 ng-show="!del">Bạn có chắc chắn muốn xóa mã giảm giá
                    <strong class="text-primary">{{detail.code_coupon}}</strong> ?</h4>
                <h4 ng-show="del">Mã giảm giá
                    <strong class="text-primary">{{detail.code_coupon}}</strong> đã được xóa thành công</h4>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal"
                    ng-click="set_is_del()">Close</button>
                <a ng-show="!del" class="btn btn-danger btn-ok" ng-click="remove(detail._id)">Delete</a>
            </div>
        </div>
    </div>
</div>

<script src="assets/js/libs/bootstrap-datepicker/bootstrap-datepicker.js"></script>

<script>
    $('.ran').datepicker({
        autoclose: true,
        todayHighlight: true,
        format: "dd/mm/yyyy",
    })

    document.getElementById("cval").onkeyup = function () {
        if (document.getElementById("cval").value != 0) {
            this.value = parseFloat(this.value.replace(/,/g, ""))
                .toFixed()
                .toString()
                .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
    }

    document.getElementById("ucval").onkeyup = function () {
        if (document.getElementById("ucval").value != 0) {
            this.value = parseFloat(this.value.replace(/,/g, ""))
                .toFixed()
                .toString()
                .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
    }
</script>