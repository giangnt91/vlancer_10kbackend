<!-- BEGIN BASE-->
<div id="base">
    <!-- BEGIN CONTENT-->
    <div id="content">
        <section>
            <div class="section-body">
                <div class="row">
                    <!-- BEGIN ALERT - REVENUE -->
                    <div class="col-md-6 col-sm-6">
                        <div class="card">
                            <div class="card-body no-padding">
                                <div class="alert alert-callout alert-info no-margin ink-reaction">
                                    <strong class="text-info text-xl">
                                        <i class="md md-dashboard"></i>
                                        <span>{{basic.length}}</span>
                                    </strong>
                                    <br/>
                                    <span class="opacity-50">Tổng Số Mã Giảm Giá</span>
                                    <div class="stick-bottom-left-right">
                                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                                    </div>
                                </div>
                            </div>
                            <!--end .card-body -->
                        </div>
                        <!--end .card -->
                    </div>
                    <!--end .col -->
                    <!-- END ALERT - REVENUE -->

                    <!-- BEGIN ALERT - REVENUE -->
                    <div class="col-md-6 col-sm-6">
                        <div class="card">
                            <div class="card-body no-padding">
                                <div class="alert alert-callout alert-danger no-margin ink-reaction" data-toggle="modal" data-target="#create">
                                    <strong class="text-danger text-xl">
                                        <i class="md md-border-color"></i>
                                        <span>Tạo Mã</span>
                                    </strong>
                                    <br/>
                                    <span class="opacity-50">Tạo Mã Giảm Giá</span>
                                    <div class="stick-bottom-left-right">
                                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                                    </div>
                                </div>
                            </div>
                            <!--end .card-body -->
                        </div>
                        <!--end .card -->
                    </div>
                    <!--end .col -->
                    <!-- END ALERT - REVENUE -->
                </div>

                <div class="row">
                    <!--end .col -->
                    <div class="col-lg-12">
                        <div class="table-responsive alert alert-callout no-margin tbaction" style="overflow-x:unset;">
                            <h2 ng-if="basic.length === 0" class="text-center">Không có dữ liệu</h2>
                            <table ng-if="basic.length > 0" datatable="" dt-options="dtOptions" dt-columns="" class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>Shop ID</th>
                                        <th>Hình Đại Diện</th>
                                        <th>Thông Tin</th>
                                        <th>Mã Giảm Giá</th>
                                        <th>Giá Trị</th>
                                        <th>Thời Hạn Sử Dụng</th>
                                        <th>Url Website</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="content in basic">
                                        <td>
                                            {{content.shopId}}
                                        </td>
                                        <td>
                                            {{content.shopImg}}
                                        </td>
                                        <td>
                                            {{content.info_coupon}}
                                        </td>
                                        <td>
                                            {{content.code_coupon}}
                                        </td>
                                        <td>
                                            {{content.value[0].value}} {{content.value[0].name}}
                                        </td>
                                        <td>
                                            {{content.expire_day}}
                                        </td>
                                        <td>
                                            {{content.shopUrl}}
                                        </td>
                                        <td class="text-center">
                                            <button type="button" class="btn btn-success ink-reaction" data-toggle="modal" data-target="#update" ng-click="get_id_action(content._id)">
                                                <i class="md md-mode-edit"></i>
                                            </button>
                                            &nbsp;
                                            <button type="button" class="btn btn-danger ink-reaction" data-toggle="modal" data-target="#delete" ng-click="get_id_action(content._id)">
                                                <i class="md md-delete"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!--end .table-responsive -->
                        <!-- END DATATABLE 1 -->
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- Update -->
<div id="update" class="modal fade" data-backdrop="static" data-keyboard="false" role="dialog">
    <div class="modal-dialog">

        <!-- update action -->
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
                <h4 class="modal-title">Cập Nhật Mã Giảm Giá</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <form class="form">
                        <div class="alert alert-info" ng-show="waiting">
                            <strong>Waiting!</strong> Đang xử lý dữ liệu vui lòng đợi ...
                        </div>
                        <div class="alert alert-warning" ng-show="error">
                            <strong>Cảnh Báo!</strong> Phải nhập đầy đủ thông tin để cập nhật mã giảm giá.
                        </div>
                        <div class="alert alert-success" ng-show="success">
                            <strong>Thành Công!</strong> Mã giảm giá đã được cập nhật.
                        </div>
                        <div class="alert alert-danger" ng-show="server_error">
                            <strong>Không Thành Công!</strong> Có lỗi trong quá trình xử lý.
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="shopId" ng-model="detail.shopId">
                            <label for="shopId">Shop ID</label>
                        </div>
                        <div class="form-group">
                            <label for="bg">Hình Đại Diện</label>
                            <br>
                            <input type="file" class="form-control-file" id="avatar2" name="avatar2" ng-files="get_avatar($files)">
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="actionUrl" ng-model="detail.code_coupon">
                            <label for="actionUrl">Mã Giảm Giá</label>
                        </div>
                        <div class="row">
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-success">
                                    <input type="radio" name="uprice" value="1" ng-model="uloai" ng-checked="detail.value[0].id === 1">
                                    <span>VNĐ</span>
                                </label>

                            </div>
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-warning">
                                    <input type="radio" name="uprice" value="2" ng-model="uloai" ng-checked="detail.value[0].id === 2">
                                    <span>%</span>
                                </label>
                            </div>
                            <div class="col-md-8 col-sm-6">
                                <div class="form-group">
                                    <input type="text" class="form-control" id="ucval" ng-model="detail.value[0].value">
                                    <label for="ucval">Giá Trị</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <input id="enday2" type="text" class="form-control ran" ng-model="detail.expire_day">
                            <label>Ngày Hết Hạn</label>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="actionUrl" ng-model="detail.shopUrl">
                            <label for="actionUrl">Url Website</label>
                        </div>
                        <div class="form-group">
                            <label for="info">Thông Tin</label>
                            <textarea name="info" id="info" class="form-control" rows="3" placeholder="" ng-model="detail.info_coupon"></textarea>
                        </div>
                    </form>
                </div>
                <!--end .card-body -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" ng-click="update(detail)">
                    Cập Nhật
                </button>
            </div>
        </div>

    </div>
</div>
<!-- update -->

<div id="create" class="modal fade" data-backdrop="static" data-keyboard="false" role="dialog">
    <div class="modal-dialog">
        <!-- create action-->
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
                <h4 class="modal-title">Tạo Mã Giảm Giá</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <form class="form">
                        <div class="alert alert-info" ng-show="waiting">
                            <strong>Waiting!</strong> Đang xử lý dữ liệu vui lòng đợi ...
                        </div>
                        <div class="alert alert-warning" ng-show="error">
                            <strong>Cảnh Báo!</strong> Phải nhập đầy đủ thông tin để tạo mã giảm giá mới.
                        </div>
                        <div class="alert alert-success" ng-show="success">
                            <strong>Thành Công!</strong> Mã giảm giá mới đã được tạo.
                        </div>
                        <div class="alert alert-danger" ng-show="server_error">
                            <strong>Không Thành Công!</strong> Có lỗi trong quá trình xử lý.
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="shopId" ng-model="data.shopid">
                            <label for="shopId">Shop ID</label>
                        </div>
                        <div class="form-group">
                            <label for="bg">Hình Đại Diện</label>
                            <br>
                            <input type="file" class="form-control-file" id="avatar" name="avatar" ng-files="get_avatar($files)">
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="actionUrl" ng-model="data.basiccode">
                            <label for="actionUrl">Mã Giảm Giá</label>
                        </div>

                        <div class="row">
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-success">
                                    <input type="radio" name="price" value="1" ng-model="loai">
                                    <span>VNĐ</span>
                                </label>

                            </div>
                            <div class="col-md-2 col-sm-6">
                                <label class="radio-inline radio-styled radio-warning">
                                    <input type="radio" name="price" value="2" ng-model="loai">
                                    <span>%</span>
                                </label>
                            </div>
                            <div class="col-md-8 col-sm-6">
                                <div class="form-group">
                                    <input type="text" class="form-control" id="cval" ng-model="data.value">
                                    <label for="cval">Giá Trị</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <input id="enday" type="text" class="form-control ran">
                            <label>Ngày Hết Hạn</label>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="actionUrl" ng-model="data.url">
                            <label for="actionUrl">Url Website</label>
                        </div>
                        <div class="form-group">
                            <label for="info">Thông Tin</label>
                            <textarea name="info" id="info" class="form-control" rows="3" placeholder="" ng-model="data.info"></textarea>
                        </div>
                    </form>
                </div>
                <!--end .card-body -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" ng-click="create(data)">
                    Tạo
                </button>
            </div>
        </div>
    </div>
</div>




<!-- Modal delete -->
<div class="modal fade" id="delete" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Confirm Delete</h4>
            </div>

            <div class="modal-body">
                <h4 ng-show="!del">Bạn có chắc chắn muốn xóa mã giảm giá
                    <strong class="text-primary">{{detail.code_coupon}}</strong> ?</h4>
                <h4 ng-show="del">Mã giảm giá
                    <strong class="text-primary">{{detail.code_coupon}}</strong> đã được xóa thành công</h4>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="set_is_del()">Close</button>
                <a ng-show="!del" class="btn btn-danger btn-ok" ng-click="remove(detail._id)">Delete</a>
            </div>
        </div>
    </div>
</div>

<script src="assets/js/libs/bootstrap-datepicker/bootstrap-datepicker.js"></script>

<script>
    $('.ran').datepicker({
        autoclose: true,
        todayHighlight: true,
        format: "dd/mm/yyyy",
    })

    document.getElementById("cval").onkeyup = function () {
        if (document.getElementById("cval").value != 0) {
            this.value = parseFloat(this.value.replace(/,/g, ""))
                .toFixed()
                .toString()
                .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
    }

    document.getElementById("ucval").onkeyup = function () {
        if (document.getElementById("ucval").value != 0) {
            this.value = parseFloat(this.value.replace(/,/g, ""))
                .toFixed()
                .toString()
                .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
    }
</script>